<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>入住登记</title>
    <!-- 引入css资源 -->
    <link rel="stylesheet" href="../../../lib/layui-v2.5.5/css/layui.css" media="all">
    <link rel="stylesheet" href="../../../css/public.css" media="all">
    <!-- 文件上传css -->
    <link rel="stylesheet" href="../../../lib/jq-module/zyupload/zyupload-1.0.0.min.css" media="all">
    <!-- 分布表单样式 -->
    <link rel="stylesheet" href="../../../js/lay-module/step-lay/step.css" media="all">
</head>

<body>
    <!-- 分布表单内容-start- -->
    <div class="layuimini-container" style="height:900px">
        <div class="layuimini-main">
            <div class="layui-card-body" style="padding-top: 40px;">
                <div class="layui-carousel" id="stepForm" lay-filter="stepForm" style="margin: 0 auto;">
                    <div carousel-item style="min-height: 750px;">
                        <!-- 基本信息 -->
                        <div>
                            <form class="layui-form" style="margin: 0 auto;max-width: 800px;padding-top: 40px;">
                                <!-- 并列一行 start -->
                                <div class="layui-form-item">
                                    <div class="layui-inline">
                                        <label class="layui-form-label required">姓名</label>
                                        <div class="layui-input-block">
                                            <input class="layui-input" type="text" id="full_name" lay-verify="required" placeholder="请输入姓名" />
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label required">身份证号</label>
                                        <div class="layui-input-block">
                                            <input class="layui-input" type="text" id="id_card" lay-verify="identity" placeholder="请输入身份证号" style="width: 240px;" />
                                        </div>
                                    </div>
                                </div>
                                <!-- 并列一行 end -->

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">生日</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" type="text" id="birthday" placeholder="yyyy-MM-dd" disabled="true" autocomplete="off" />
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">性别</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" type="radio" name="gender" value="男" title="男" checked="true" />
                                        <input class="layui-input" type="radio" name="gender" value="女" title="女" />
                                    </div>
                                </div>
                                <!-- 并列一行 start -->
                                <div class="layui-form-item">
                                    <div class="layui-inline">
                                        <label class="layui-form-label">头像</label>
                                        <div class="layui-input-block">
                                            <button type="button" class="layui-btn" id="test1">
                                                <i class="layui-icon layui-icon-upload"></i>上传头像
                                            </button>
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label">
                                            <img id="comm_img" style="width:auto;height:50px;" />
                                        </label>
                                    </div>
                                </div>
                                <!-- 并列一行 end -->

                                <!-- 并列一行 start -->
                                <div class="layui-form-item">
                                    <div class="layui-inline">
                                        <label class="layui-form-label">年龄</label>
                                        <div class="layui-input-block">
                                            <input class="layui-input" id="age" lay-verify="number" disabled="true" placeholder="请输入年龄" />
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label">民族</label>
                                        <div class="layui-input-block">
                                            <select id="nation" name="nation" lay-verify="required" lay-reqtext="请选择民族">
                                                <option value="汉族">汉族</option>
                                                <option value="蒙古族">蒙古族</option>
                                                <option value="回族">回族</option>
                                                <option value="藏族">藏族</option>
                                                <option value="维吾尔族">维吾尔族</option>
                                                <option value="苗族">苗族</option>
                                                <option value="彝族">彝族</option>
                                                <option value="壮族">壮族</option>
                                                <option value="布依族">布依族</option>
                                                <option value="朝鲜族">朝鲜族</option>
                                                <option value="满族">满族</option>
                                                <option value="侗族">侗族</option>
                                                <option value="瑶族">瑶族</option>
                                                <option value="白族">白族</option>
                                                <option value="土家族">土家族</option>
                                                <option value="哈尼族">哈尼族</option>
                                                <option value="哈萨克族">哈萨克族</option>
                                                <option value="傣族">傣族</option>
                                                <option value="黎族">黎族</option>
                                                <option value="傈僳族">傈僳族</option>
                                                <option value="佤族">佤族</option>
                                                <option value="畲族">畲族</option>
                                                <option value="高山族">高山族</option>
                                                <option value="拉祜族">拉祜族</option>
                                                <option value="水族">水族</option>
                                                <option value="东乡族">东乡族</option>
                                                <option value="纳西族">纳西族</option>
                                                <option value="景颇族">景颇族</option>
                                                <option value="柯尔克孜族">柯尔克孜族</option>
                                                <option value="土族">土族</option>
                                                <option value="达斡尔族">达斡尔族</option>
                                                <option value="仫佬族">仫佬族</option>
                                                <option value="羌族">羌族</option>
                                                <option value="布朗族">布朗族</option>
                                                <option value="撒拉族">撒拉族</option>
                                                <option value="毛南族">毛南族</option>
                                                <option value="仡佬族">仡佬族</option>
                                                <option value="锡伯族">锡伯族</option>
                                                <option value="阿昌族">阿昌族</option>
                                                <option value="普米族">普米族</option>
                                                <option value="塔吉克族">塔吉克族</option>
                                                <option value="怒族">怒族</option>
                                                <option value="乌孜别克族">乌孜别克族</option>
                                                <option value="俄罗斯族">俄罗斯族</option>
                                                <option value="鄂温克族">鄂温克族</option>
                                                <option value="德昂族">德昂族</option>
                                                <option value="保安族">保安族</option>
                                                <option value="裕固族">裕固族</option>
                                                <option value="京族">京族</option>
                                                <option value="塔塔尔族">塔塔尔族</option>
                                                <option value="独龙族">独龙族</option>
                                                <option value="鄂伦春族">鄂伦春族</option>
                                                <option value="赫哲族">赫哲族</option>
                                                <option value="门巴族">门巴族</option>
                                                <option value="珞巴族">珞巴族</option>
                                                <option value="基诺族">基诺族</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <!-- 并列一行 end -->

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label required">联系电话</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" type="text" id="phone" lay-verify="tellphone" placeholder="请输入联系电话" />
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">户籍地址</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" type="text" id="permanent_address" placeholder="请输入户籍地址" />
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">爱&#12288;&#12288;好</label>
                                    <div class="layui-input-block">
                                        <textarea class="layui-textarea" placeholder="请输入爱好" id="hobby"></textarea>
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">饮食禁忌</label>
                                    <div class="layui-input-block">
                                        <textarea class="layui-textarea" placeholder="请输入饮食禁忌" id="diet_taboo"></textarea>
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <div class="layui-input-block">
                                        <button class="layui-btn layui-btn-primary" lay-submit lay-filter="formStep"><i
                                                class="layui-icon layui-icon-right"></i>
                                            &emsp;下一步&emsp;
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <!-- 家属信息 -->
                        <div>
                            <form class="layui-form" style="margin: 0 auto;max-width: 750px;padding-top: 40px;">
                                <!-- 并列一行 start -->
                                <div class="layui-form-item">
                                    <div class="layui-inline">
                                        <label class="layui-form-label required">家属姓名</label>
                                        <div class="layui-input-block">
                                            <input class="layui-input" type="text" id="family_name" lay-verify="required" lay-reqtext="请输入家属姓名" placeholder="请输入家属姓名" />
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label required">身份证号</label>
                                        <div class="layui-input-block">
                                            <input class="layui-input" type="text" id="family_card" lay-verify="identity" placeholder="请输入身份证号" style="width: 240px;" />
                                        </div>
                                    </div>
                                </div>
                                <!-- 并列一行 end -->

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label required">联系电话</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" type="text" id="family_phone" lay-verify="tellphone" placeholder="请输入联系电话" />
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">关&#12288;&#12288;系</label>
                                    <div class="layui-input-block">
                                        <select id="and_relation" id="and_relation">
                                            <option value="祖孙">祖孙</option>
                                            <option value="父子">父子</option>
                                            <option value="父女">父女</option>
                                            <option value="母子">母子</option>
                                            <option value="母女">母女</option>
                                            <option value="姐妹">姐妹</option>
                                            <option value="兄妹">兄妹</option>
                                            <option value="姐弟">姐弟</option>
                                            <option value="叔侄">叔侄</option>
                                            <option value="公孙">公孙</option>
                                            <option value="孙女">孙女</option>
                                            <option value="孙子">孙子</option>
                                            <option value="兄弟">兄弟</option>
                                            <option value="侄女">侄女</option>
                                            <option value="外孙女">外孙女</option>
                                            <option value="妻子">妻子</option>
                                            <option value="姊妹">姊妹</option>
                                            <option value="配偶">配偶</option>
                                            <option value="女婿">女婿</option>
                                            <option value="儿媳">儿媳</option>
                                            <option value="婆媳">婆媳</option>
                                            <option value="夫妻">夫妻</option>
                                            <option value="户主">户主</option>
                                            <option value="子女">子女</option>
                                            <option value="其他">其他</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label required">联系地址</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" type="text" id="contact_address" lay-verify="required" lay-reqtext="请输入联系地址" placeholder="请输入联系地址" />
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">是否监护人</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" type="radio" name="is_guardian" value="是" title="是" checked="true" />
                                        <input class="layui-input" type="radio" name="is_guardian" value="否" title="否" />
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <div class="layui-input-block">
                                        <button class="layui-btn layui-btn-primary" lay-submit lay-filter="formStep2"><i
                                                class="layui-icon layui-icon-right"></i>
                                            &emsp;下一步&emsp;
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- 健康信息 -->
                        <div>
                            <form class="layui-form" style="margin: 0 auto;max-width: 800px;padding-top: 30px;">
                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">自理情况</label>
                                    <div class="layui-input-block">
                                        <select id="hea_zili_situation" name="hea_zili_situation" lay-verify="required" lay-reqtext="请选择自理情况">
                                            <option value="正常">正常</option>
											<option value="介助">介助</option>
                                            <option value="介护">介护</option>
                                            <option value="自理">自理</option>
                                            <option value="失能老人">失能老人</option>
                                            <option value="半失能老人">半失能老人</option>
                                            <option value="其他">其他</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- 并列一行 start -->
                                <div class="layui-form-item">
                                    <div class="layui-inline">
                                        <label class="layui-form-label">视力情况</label>
                                        <div class="layui-input-block">
                                            <select id="hea_vision" name="hea_vision" lay-verify="required" lay-reqtext="请选择视力情况">
                                                <option value="正常">正常</option>
                                                <option value="有损">有损</option>
                                                <option value="失明">失明</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label">听力情况</label>
                                        <div class="layui-input-block">
                                            <select id="hea_hearing" name="hea_hearing" lay-verify="required" lay-reqtext="请选择听力情况" />
                                            <option value="正常">正常</option>
                                            <option value="轻度听力障碍">轻度听力障碍</option>
                                            <option value="重度听力障碍">重度听力障碍</option>
                                            <option value="失聪">失聪</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <!-- 并列一行 end -->

                                <!-- 并列一行 start -->
                                <div class="layui-form-item">
                                    <div class="layui-inline">
                                        <label class="layui-form-label">主治医院</label>
                                        <div class="layui-input-block">
                                            <input class="layui-input" type="text" id="hea_zhuzhi_hospital" placeholder="请输入主治医院" />
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label">主治医师</label>
                                        <div class="layui-input-block">
                                            <input class="layui-input" type="text" id="hea_zhuzhi_doctor" placeholder="请输入主治医师" />
                                        </div>
                                    </div>
                                </div>
                                <!-- 并列一行 end -->

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">医院电话</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" type="tel" id="hea_hospital_phone" oninput="value=value.replace(/[^\d]/g,'')" placeholder="请输入医院电话" />
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">过敏药物</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" type="text" id="hea_allergy_medicine" placeholder="请输入过敏药物" />
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">病史情况</label>
                                    <div class="layui-input-block">
                                        <textarea class="layui-textarea" placeholder="请输入病史情况" id="hea_medical_history"></textarea>
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">主要疾病</label>
                                    <div class="layui-input-block">
                                        <input type="checkbox" name="hea_zhuyao_disease" value="高血糖" title="高血糖">
                                        <input type="checkbox" name="hea_zhuyao_disease" value="高血压" title="高血压">
                                        <input type="checkbox" name="hea_zhuyao_disease" value="心脏病" title="心脏病">
                                        <input type="checkbox" name="hea_zhuyao_disease" value="脑血栓" title="脑血栓">
                                        <input type="checkbox" name="hea_zhuyao_disease" value="冠心病" title="冠心病">
                                        <input type="checkbox" name="hea_zhuyao_disease" value="关节炎" title="关节炎">
                                        <input type="checkbox" name="hea_zhuyao_disease" value="风湿" title="风湿">
                                        <input type="checkbox" name="hea_zhuyao_disease" value="其他" title="其他">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <div class="layui-input-block">
                                        <button class="layui-btn layui-btn-primary" lay-submit lay-filter="formStep3"><i
                                                class="layui-icon layui-icon-right"></i>
                                            &emsp;下一步&emsp;
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <!-- 护理任务 -->
                        <div>
                            <form class="layui-form" style="margin: 0 auto;max-width: 750px;padding-top: 40px;">
                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">护理级别</label>
                                    <div class="layui-input-block">
                                        <select id="nt_level" name="nt_level" lay-verify="required" lay-reqtext="请选择护理级别">
                                            <option value="普通护理">普通护理</option>
                                            <option value="中级护理">中级护理</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- 单独一行(带说明) -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label required">护理费用</label>
                                    <div class="layui-input-inline">
                                        <input class="layui-input" type="text" id="nt_level_cost" lay-verify="required" lay-reqtext="请输入护理费用" oninput="value=value.replace(/[^\d]/g,'')" placeholder="请输入护理费用">
                                    </div>
                                    <div class="layui-form-mid layui-word-aux">元/月</div>
                                </div>
                                <div class="layui-form-item">
                                    <div class="layui-input-block">
                                        <button class="layui-btn layui-btn-primary" lay-submit lay-filter="formStep4"><i
                                                class="layui-icon layui-icon-right"></i>
                                            &emsp;下一步&emsp;
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- 床位选择 -->
                        <div>
                            <form class="layui-form" style="margin: 0 auto;max-width: 700px;padding-top: 40px;">
                                <!-- 并列一行 start -->
                                <div class="layui-form-item">
                                    <div class="layui-inline">
                                        <label class="layui-form-label required">餐饮套餐</label>
                                        <div class="layui-input-block">
                                            <select id="bed_catering_package" name="bed_catering_package" lay-verify="required" lay-reqtext="请选择套餐">
                                                <option value="两菜一汤">两菜一汤</option>
                                                <option value="一荤一素">一荤一素</option>
                                                <option value="其他">其他</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label required">套餐费用</label>
                                        <div class="layui-input-inline">
                                            <input class="layui-input" id="bed_cost_meal_package" name="bed_cost_meal_package" oninput="value=value.replace(/[^\d]/g,'')" placeholder="请输入费用" />
                                        </div>
                                        <div class="layui-form-mid layui-word-aux">元/月</div>
                                    </div>
                                </div>
                                <!-- 并列一行 end -->

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">套餐详情</label>
                                    <div class="layui-input-block">
                                        <textarea class="layui-textarea" placeholder="请输入套餐详情" id="bed_catering_package_details"></textarea>
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label required">床位类型</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" type="radio" name="bed_type" value="高级" title="高级" checked="true" />
                                        <input class="layui-input" type="radio" name="bed_type" value="中级" title="中级" />
                                        <input class="layui-input" type="radio" name="bed_type" value="一般" title="一般" />
                                    </div>
                                </div>

                                <!-- 并列一行 start -->
                                <div class="layui-form-item">
                                    <div class="layui-inline">
                                        <label class="layui-form-label">选择床位</label>
                                        <div class="layui-input-block">
                                            <input class="layui-input" readonly unselectable="on" name="bed" id="bed" lay-submit lay-filter="bedbutton" placeholder="请选择床位" />
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label required">床位费用</label>
                                        <div class="layui-input-inline">
                                            <input class="layui-input" id="bed_cost" name="bed_cost" oninput="value=value.replace(/[^\d]/g,'')" placeholder="请输入床位费用" />
                                        </div>
                                        <div class="layui-form-mid layui-word-aux">元/月</div>
                                    </div>
                                </div>
                                <!-- 并列一行 end -->

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">是否包房</label>
                                    <div class="layui-input-block">
                                        <input type="radio" name="bed_is_baofang" value="是" title="是" checked="true" />
                                        <input type="radio" name="bed_is_baofang" value="否" title="否" />
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">床位描述</label>
                                    <div class="layui-input-block">
                                        <textarea class="layui-textarea" placeholder="请输入床位描述" id="bed_describe"></textarea>
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">备&#12288;&#12288;注</label>
                                    <div class="layui-input-block">
                                        <textarea class="layui-textarea" placeholder="请输入备注" id="bed_remark"></textarea>
                                    </div>
                                </div>
                                <!-- 床位id -->
                                <input id="bedId" type="text" style="display: none" readonly="" value=''>

                                <div class="layui-form-item" style="margin-top:10px">
                                    <div class="layui-input-block">
                                        <button class="layui-btn layui-btn-primary" lay-submit lay-filter="formStep5"><i
                                                class="layui-icon layui-icon-right"></i>
                                            &emsp;下一步&emsp;
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <!-- 入院缴费 -->
                        <div>
                            <form class="layui-form" style="margin: 0 auto;max-width: 750px;padding-top: 20px;">
                                <!-- 并列一行 start -->
                                <div class="layui-form-item">
                                    <div class="layui-inline">
                                        <label class="layui-form-label required">押&#12288;&#12288;金</label>
                                        <div class="layui-input-block">
                                            <input class="layui-input" id="ap_deposit" type="text" name="ap_deposit" lay-verify="required" lay-reqtext="押金" oninput="value=value.replace(/[^\d]/g,'')" placeholder="请输入押金">
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label required">预缴费用</label>
                                        <div class="layui-input-block">
                                            <input class="layui-input" id="ap_cost_advance" type="text" lay-verify="required" lay-reqtext="请输入预缴费用" name="ap_cost_advance" oninput="value=value.replace(/[^\d]/g,'')" placeholder="请输入预缴费用">
                                        </div>
                                    </div>
                                </div>
                                <!-- 并列一行 end -->

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">套餐费用</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" readonly type="text" id="ap_cost_meal_package" oninput="value=value.replace(/[^\d]/g,'')" placeholder="请输入套餐费用" />
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">床位费用</label>
                                    <div class="layui-input-block">
                                        <input class="layui-input" readonly type="text" id="ap_cost_bed" oninput="value=value.replace(/[^\d]/g,'')" placeholder="请输入床位费用" />
                                    </div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label">应缴费用</label>
                                    <div class="layui-input-inline">
                                        <input class="layui-input" id="ap_cost_payable" readonly type="text" name="ap_cost_payable" oninput="value=value.replace(/[^\d]/g,'')" placeholder="请输入应缴费用" />
                                    </div>
                                    <div class="layui-form-mid layui-word-aux">护理+套餐+床位</div>
                                </div>

                                <!-- 单独一行 -->
                                <div class="layui-form-item">
                                    <label class="layui-form-label required">实缴费用</label>
                                    <div class="layui-input-inline">
                                        <input class="layui-input" id="ap_cost_total" readonly type="text" name="ap_cost_total" oninput="value=value.replace(/[^\d]/g,'')" placeholder="请输入实缴费用" />
                                    </div>
                                    <div class="layui-form-mid layui-word-aux">押金+预缴+应缴</div>
                                </div>

                                <input id="family_id" type="text" style="display: none" readonly="" value=''>

                                <div class="layui-form-item" style="margin-top:40px">
                                    <div class="layui-input-block">
                                        <button class="layui-btn" lay-submit lay-filter="formStep6"><i
                                                class="layui-icon layui-icon-add-circle-fine"></i>
                                            &emsp;完成登记&emsp;
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div>
                            <!-- 结束标题 -->
                            <input id="guanlian_id" type="text" style="display: none" readonly="" value=''>
                            <div style="text-align: center;margin-top: 90px;">
                                <i class="layui-icon layui-circle" style="color: white;font-size:30px;font-weight:bold;background: #52C41A;padding: 20px;line-height: 80px;">&#xe605;</i>
                                <div style="font-size: 24px;color: #333;font-weight: 500;margin-top: 30px;">
                                    登记成功
                                </div>
                                <div style="font-size: 14px;color: #666;margin-top: 20px;"></div>
                            </div>
                            <div style="text-align: center;margin-top: 50px;">
                                <button class="layui-btn next">继续登记</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 分布表单内容--end -->

    <!-- 引入js资源 -->
    <script src="../../../lib/layui-v2.5.5/layui.js" charset="utf-8"></script>
    <script src="../../../js/lay-config.js?v=1.0.4" charset="utf-8"></script>
    <script src="../../bcxt/login/login.js"></script>
    <script>
        // 加载组件
        layui.use(['form', 'step', "tree", 'treetable', 'laydate', 'upload', 'layarea'], function() {
                var $ = layui.$,
                    form = layui.form,
                    layer = layui.layer,
                    laydate = layui.laydate;
                var tree = layui.tree;
                var treetable = layui.treetable;
                var layarea = layui.layarea;
                var upload = layui.upload;
                step = layui.step;
                var token = Storage.get("token");
				
				//下一步
                $('.next').click(function() {
                    step.next('#stepForm');
                });
				
                //验证电话号码或座机号码
                var mobile = /^([0-9]{3,4}-)?[0-9]{7,8}$/,
                    phone = /^((\+?86)|(\(\+86\)))?(13[012356789][0-9]{8}|15[012356789][0-9]{8}|18[02356789][0-9]{8}|147[0-9]{8}|1349[0-9]{7})$/;
                form.verify({
                    tellphone: function(value) {
                        var flag = mobile.test(value) || phone.test(value);
                        if (!flag) {
                            return '请输入正确座机号码或手机号';
                        }
                    }
                });

                //图片上传
                var uploadInst = upload.render({
                    elem: '#test1',
                    url: '/sys_fkcy/images/imageUpload.action',
                    headers: header,
                    done: function(res, index, upload) {
                        if (res.state == 200) {
                            $("#comm_img").attr("src", res.data.imgUrl);
                            layer.msg(res.msg, {
                                icon: 6,
                                time: 1000
                            });
                        } else {
                            layer.msg(res.msg, {
                                icon: 5,
                                time: 1000
                            });
                        }
                    }
                });

                /* 监听床位信息*/
                form.on('submit(bedbutton)', function(data) {
                    var index = layer.open({
                        title: '床位信息',
                        type: 2,
                        shade: 0.2,
                        maxmin: true,
                        shadeClose: true,
                        area: ['400px', '350px'],
                        content: './bedselection/bedInfo.html',
                        success: function(layero, index) { //弹出层打开后的回调函数
                            // layer.full(index);
                            var iframe = window['layui-layer-iframe' + index];

                        }
                    });

                });

                //3秒请求一次刷新数据
                window.reloadView = function() {
                    getAge();
                }
                setInterval('reloadView()', 1000);
                getAge();
                // 根据身份证信息获取生日、性别、年龄
                function getAge() {
                    //获取输入身份证号码 
                    var UUserCard = $("#id_card").val();
                    if (UUserCard != null && UUserCard != '') {
                        //获取生日
                        var birthday = UUserCard.substring(6, 10) + "-" + UUserCard.substring(10, 12) + "-" + UUserCard.substring(12, 14);
                        $("#birthday").val(birthday);
                        //获取性别 
                        if (parseInt(UUserCard.substr(16, 1)) % 2 == 1) {
                            $(".gender").val('男');
                            $("#genderMan").prop("checked", true);
                            $("#genderWoman").prop("checked", false);
                        } else {
                            $(".gender").val('女');
                            $("#genderWoman").prop("checked", true);
                            $("#genderMan").prop("checked", false);
                        }
                        //获取年龄 
                        var myDate = new Date();
                        var month = myDate.getMonth() + 1;
                        var day = myDate.getDate();
                        var age = myDate.getFullYear() - UUserCard.substring(6, 10) - 1;
                        if (UUserCard.substring(10, 12) < month || UUserCard.substring(10, 12) == month && UUserCard.substring(12, 14) <= day) {
                            age++;
                        }
                        $("#age").val(age);
                    }
                }

                // 56个民族
                var nations = ["汉族", "蒙古族", "回族", "藏族", "维吾尔族", "苗族", "彝族", "壮族", "布依族", "朝鲜族", "满族", "侗族", "瑶族", "白族", "土家族",
                    "哈尼族", "哈萨克族", "傣族", "黎族", "傈僳族", "佤族", "畲族", "高山族", "拉祜族", "水族", "东乡族", "纳西族", "景颇族", "柯尔克孜族",
                    "土族", "达斡尔族", "仫佬族", "羌族", "布朗族", "撒拉族", "毛南族", "仡佬族", "锡伯族", "阿昌族", "普米族", "塔吉克族", "怒族", "乌孜别克族",
                    "俄罗斯族", "鄂温克族", "德昂族", "保安族", "裕固族", "京族", "塔塔尔族", "独龙族", "鄂伦春族", "赫哲族", "门巴族", "珞巴族", "基诺族"
                ];

                function initNations() {
                    var staff_nation = document.getElementById("staff_nation");
                    for (var i in nations) {
                        staff_nation.add(new Option(nations[i], i));
                    }
                }

                //日期-生日
                laydate.render({
                    elem: '#birthday'
                });

                // 分布表单标题步骤
                step.render({
                    elem: '#stepForm',
                    filter: 'stepForm',
                    width: '100%', //设置容器宽度
                    stepWidth: '900px',
                    height: '450px',
                    stepItems: [{
                        title: '填写基本信息'
                    }, {
                        title: '填写家属信息'
                    }, {
                        title: '填写健康信息'
                    }, {
                        title: '护理任务设置'
                    }, {
                        title: '餐饮床位选择'
                    }, {
                        title: '入院缴费'
                    }, {
                        title: '完成'
                    }]
                });

                /*
                监听基本信息
                */
                form.on('submit(formStep)', function(data) {
                    var age = $("#age").val();
                    if (parseFloat(age) < 0 || parseFloat(age) > 140) {
                        layer.msg("请检查身份证是否正确！", {
                            icon: 5, //失败的表情
                            time: 1000, //1秒关闭（如果不配置，默认是3秒）
                        });
                    } else {
                        $.ajax({
                            url: '/sys_fkcy/essential_information/save.action',
                            context: document.body,
                            headers: { //通过 request 头传递
                                token: token
                            },
                            type: "POST",
                            // dataType: "data",
                            data: {
                                "full_name": $("#full_name").val(),
                                "id_card": $("#id_card").val(),
                                "birthday": $("#birthday").val(),
                                "gender": $("input[name='gender']:checked").val(),
                                "age": $("#age").val(),
                                "nation": $("#nation").val(),
                                "phone": $("#phone").val(),
                                "permanent_address": $("#permanent_address").val(),
                                "hobby": $("#hobby").val(),
                                "img": $("#comm_img").attr("src"),
                                "diet_taboo": $("#diet_taboo").val()
                            },
                            xhrFields: {
                                withCredentials: true
                            },
                            success: function(data) {
                                if (data.state == 200) {
                                    layer.msg(data.msg, {
                                        icon: 6, //成功的表情
                                        time: 1000, //1秒关闭（如果不配置，默认是3秒）
                                    });
                                    $("#guanlian_id").val(data.data.id);
									//跳转下一步
									step.next('#stepForm');
                                }else{
									layer.msg(data.msg, {
										icon: 5, //失败的表情
										time: 3000, //1秒关闭（如果不配置，默认是3秒）
									});
									return false;
								}
                            }
                        });
                    }
                    return false;
                });

                /*
                监听家庭信息
                */
                form.on('submit(formStep2)', function(data) {

                    $.ajax({
                        url: '/sys_fkcy/family_information/save.action',
                        context: document.body,
                        headers: { //通过 request 头传递
                            token: token
                        },
                        type: "POST",
                        // dataType: "data",
                        data: {
                            "yw_id": $("#guanlian_id").val(),
                            "full_name": $("#family_name").val(),
                            "phone": $("#family_phone").val(),
                            "id_card": $("#family_card").val(),
                            "contact_address": $("#contact_address").val(),
                            "and_relation": $("#and_relation").val(),
                            "is_guardian": $("input[name='is_guardian']:checked").val()

                        },
                        xhrFields: {
                            withCredentials: true
                        },
                        success: function(data) {
                            if (data.state == 200) {
                                layer.msg(data.msg, {
                                    icon: 6, //成功的表情
                                    time: 1000 //1秒关闭（如果不配置，默认是3秒）
                                });
                            }
                        }
                    });
                    step.next('#stepForm');
                    return false;
                });

                /*
                 监听健康信息
                 */
                form.on('submit(formStep3)', function(data) {
                    //获取checkbox[name='hea_zhuyao_disease]的值
                    var arr = new Array();
                    $("input:checkbox[name='hea_zhuyao_disease']:checked").each(function(i) {
                        arr[i] = $(this).val();
                    });
                    var hea_zhuyao_disease = arr.join(","); //将数组合并成字符串
                    $.ajax({
                        url: '/sys_fkcy/healthy_info/save.action',
                        context: document.body,
                        headers: { //通过 request 头传递
                            token: token
                        },
                        type: "POST",
                        // dataType: "data",
                        data: {
                            "yw_id": $("#guanlian_id").val(),
                            "hea_zili_situation": $("#hea_zili_situation").val(),
                            "hea_vision": $("#hea_vision").val(),
                            "hea_hearing": $("#hea_hearing").val(),
                            "hea_zhuzhi_hospital": $("#hea_zhuzhi_hospital").val(),
                            "hea_zhuzhi_doctor": $("#hea_zhuzhi_doctor").val(),
                            "hea_hospital_phone": $("#hea_hospital_phone").val(),
                            "hea_allergy_medicine": $("#hea_allergy_medicine").val(),
                            "hea_medical_history": $("#hea_medical_history").val(),
                            "hea_zhuyao_disease": hea_zhuyao_disease

                        },
                        xhrFields: {
                            withCredentials: true
                        },
                        success: function(data) {
                            if (data.state == 200) {
                                layer.msg(data.msg, {
                                    icon: 6, //成功的表情
                                    time: 1000 //1秒关闭（如果不配置，默认是3秒）
                                });
                            }
                        }
                    });
                    step.next('#stepForm');
                    return false;
                });

                /* 
                监听护理任务
                 */
                form.on('submit(formStep4)', function(data) {
                    $.ajax({
                        url: '/sys_fkcy/jggl/nursing_task/save.action',
                        context: document.body,
                        headers: { //通过 request 头传递
                            token: token
                        },
                        type: "POST",
                        // dataType: "data",
                        data: {
                            "yw_id": $("#guanlian_id").val(),
                            "nt_level": $("#nt_level").val(),
                            "nt_level_cost": $("#nt_level_cost").val()
                        },
                        xhrFields: {
                            withCredentials: true
                        },
                        success: function(data) {
                            if (data.state == 200) {
                                layer.msg(data.msg, {
                                    icon: 6, //成功的表情
                                    time: 1000 //1秒关闭（如果不配置，默认是3秒）
                                });
                            }
                        }
                    });
                    step.next('#stepForm');
                    return false;
                });

                /*
                 监听床位选择
                 */
                form.on('submit(formStep5)', function(data) {
                    var bed = $("#bed").val();
                    var bed_cost = $("#bed_cost").val();
                    if (!bed) {
                        layer.msg("请选择床位！", {
                            icon: 5, //失败的表情
                            time: 1000 //1秒关闭（如果不配置，默认是3秒）
                        });
                        return false;
                    } else if (!bed_cost) {
                        layer.msg("请输入床位费用！", {
                            icon: 5, //失败的表情
                            time: 1000 //1秒关闭（如果不配置，默认是3秒）
                        });
                        return false;
                    } else {
                        $.ajax({
                            url: '/sys_fkcy/bed_selection/save.action',
                            context: document.body,
                            headers: { //通过 request 头传递
                                token: token
                            },
                            type: "POST",
                            // dataType: "data",
                            data: {
                                "yw_id": $("#guanlian_id").val(),
                                "bed_catering_package": $("#bed_catering_package").val(),
                                "bed_cost_meal_package": $("#bed_cost_meal_package").val(),
                                "bed_catering_package_details": $("#bed_catering_package_details").val(),
                                "bed_id": $("#bedId").val(),
                                "bed_type": $("input[name='bed_type']:checked").val(),
                                "bed_is_baofang": $("input[name='bed_is_baofang']:checked").val(),
                                "bed_cost": $("#bed_cost").val(),
                                "bed_remark": $("#bed_remark").val(),
                                "bed": $("#bed").val(),
                                "bed_describe": $("#bed_describe").val()

                            },
                            xhrFields: {
                                withCredentials: true
                            },
                            success: function(data) {
                                if (data.state == 200) {
                                    layer.msg(data.msg, {
                                        icon: 6, //成功的表情
                                        time: 1000 //1秒关闭（如果不配置，默认是3秒）
                                    });
									
									//下一步
                                    step.next('#stepForm');
									
									//获取缴费信息
									yingjiao();
									ruyuanjfe_jshs();
                                } else {
                                    layer.msg(data.msg, {
                                        icon: 5,
                                        time: 1000
                                    });
                                    return false;
                                }
                            }
                        });
                    }
                    return false;
                });
				
                /* 
                监听入院缴费
                 */
                //入院缴费-押金输入框的值改变时触发
                $("#ap_deposit").on("input", function(e) {
                    ruyuanjfe_jshs();
                });
                //入院缴费-预存输入框的值改变时触发
                $("#ap_cost_advance").on("input", function(e) {
                    ruyuanjfe_jshs();
                });
                //获取缴费信息并赋值
                function yingjiao() {
                    var ap_cost_meal_package = $("#bed_cost_meal_package").val();
                    var ap_cost_bed = $("#bed_cost").val();
                    var nt_level_cost = $("#nt_level_cost").val();
                    //计算
                    var ap_cost_payable = (parseInt(nt_level_cost) +
                        parseInt(ap_cost_bed) +
                        parseInt(ap_cost_meal_package));
                    //赋值应缴
                    $("#ap_cost_meal_package").val(ap_cost_meal_package);
                    $("#ap_cost_bed").val(ap_cost_bed);
                    $("#ap_cost_payable").val(ap_cost_payable);
                }
                //入院缴费-计算函数
                function ruyuanjfe_jshs() {
                    //得到押金
                    var ap_deposit = $("#ap_deposit").val();
                    if (ap_deposit == "" || ap_deposit == null || ap_deposit == 'undefined') {
                        ap_deposit = 0;
                    }
                    //得到预缴
                    var ap_cost_advance = $("#ap_cost_advance").val();
                    if (ap_cost_advance == "" || ap_cost_advance == null || ap_cost_advance == 'undefined') {
                        ap_cost_advance = 0;
                    }

                    //得到应缴
                    var ap_cost_payable = $("#ap_cost_payable").val();

                    //计算
                    var ap_cost_total = (parseInt(ap_cost_payable) +
                        parseInt(ap_cost_advance) +
                        parseInt(ap_deposit));
                    //赋值实缴
                    $("#ap_cost_total").val(ap_cost_total);
                }
                form.on('submit(formStep6)', function(data) {
                    $.ajax({
                        url: '/sys_fkcy/admission_payment/save.action',
                        context: document.body,
                        headers: { //通过 request 头传递
                            token: token
                        },
                        type: "POST",
                        // dataType: "data",
                        data: {
                            "yw_id": $("#guanlian_id").val(),
                            "ap_deposit": $("#ap_deposit").val(),
                            "ap_cost_meal_package": $("#ap_cost_meal_package").val(),
                            "ap_cost_bed": $("#ap_cost_bed").val(),
                            "ap_cost_payable": $("#ap_cost_payable").val(),
                            "ap_cost_advance": $("#ap_cost_advance").val(),
                            "ap_cost_total": $("#ap_cost_total").val()
                        },
                        xhrFields: {
                            withCredentials: true
                        },
                        success: function(data) {
                            if (data.state == 200) {
                                layer.msg(data.msg, {
                                    icon: 6, //成功的表情
                                    time: 1000 //1秒关闭（如果不配置，默认是3秒）
                                });
                            }
                        }
                    });
                    step.next('#stepForm');
                    return false;
                });
            })
            //父窗体调用传值
        function child(data) {
            layui.use(['jquery', 'steps'], function() {
                var $ = layui.$;
                $("#ess_id").val(data.id);
                var $step = $("#step_demo").step();
                //到指定步
                $step.goStep(data.state);
            });
        }

        // 获取第二个子页面传来的值并修改
        function getDataFromSon(data) {
            $ = layui.$;
            $("#bed").val(data.floor_tung_name + '-' + data.floor_layer + '-' + data.room_number + '-' + data.bed_number);
            $("#bedId").val(data.id);
        }
    </script>

</body>

</html>